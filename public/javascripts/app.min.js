window.tfFrames={loadFrames:function(){var e=this.output,t=e.value,a=t.split("\n"),r=a[0].split("|")[1],n=a[0].split("|")[0];this.frameCount.value=a.length,this.frameClass.value=n,this.frameName.value=r,this.generateFrames();for(var s=0;s<a.length;s++){var i=a[s].split("|");if(i.length>=3){var l=this.getFrame(i[2],i[1]);l.dataset.frameExposureCount=i[3],l.setAttribute("style",i[4])}}},generateFrames:function(){var e=(this.body,this.output,this.framesDiv),t=this.frameCount.value,a=this.frameClass.value,r=this.frameName.value,n=this.selectFrame;n.dataset.frameName=r,this.frameName2.value=r;for(var s=0,i=e.childElementCount;t>s;){var l=document.createElement("span");l.dataset.frameCount=i+1,l.dataset.frameExposureCount=1,l.setAttribute("class","opacity frame "+r+(i+1)+" "+a),l.setAttribute("style",""),e.appendChild(l);var m=document.createElement("option");m.setAttribute("value",i+1),m.innerHTML=r+(i+1),n.appendChild(m),s++,i++}},getFrame:function(e,t){for(var a=void 0,r=document.querySelectorAll('[data-frame-count="'+e+'"]'),n=0;n<r.length;){var s=r[n].className.split(" ");if(r[n].dataset.frameCount==e&&s.indexOf(t+e)>=0){a=r[n];break}}return a},_keyFrames:function(e){for(var t=0,a=1,r=this.frameCount.value,n=this.frameName.value,s=this.frameClass.value,i=n,l=0,m="@keyframes "+i+"_"+l+" {\n",u=i+"_"+l+" 1s steps(24) 1 "+l+"s normal, ",o=0,d=1,c="/* Frame Data: \n";r>t;){var p=this.getFrame(a,n),h=4.16*p.dataset.frameExposureCount;if(o+h>100){for(var v=0,f=1;f<=p.dataset.frameExposureCount&&(v=4.16*f,!(o+v>100));f++);v--,h-=v;var b=o+4.16*v;b>99&&(b=100),m+="  "+o+"%,"+b+"% {",e&&(m+="    /* frame "+(t+1)+" rules here */");var C=this.getStyle(a,n);void 0!=C&&(m+=C,c+=s+"|"+n+"|"+a+"|"+C+"\n"),m+="}\n",u+=i+"_"+l+" 1s steps(24) 1 "+l+"s normal, ",l++,d=1,o=0,m+="}\n\n",m+="@keyframes "+i+"_"+l+" {\n"}var y=o+h;y>99&&(y=100),m+="  "+o+"%,"+y+"% {",e&&(m+="    /* frame "+(t+1)+" rules here */");var C=this.getStyle(a,n);void 0!=C&&(m+=C,c+=s+"|"+n+"|"+a+"|"+p.dataset.frameExposureCount+"|"+C+"\n"),m+="}\n",o=y,d++,a++,t++}return m+="}\n\n",{animations:u.substr(0,u.length-2),keyframes:m,frameData:c}},generateKeyframes:function(){var e=this._keyFrames(!0),t=this.output,a=this.frameName.value;t.value="",t.value=t.value+"."+a+".animate {\n",t.value=t.value+"  animation: "+e.animations+";\n",t.value=t.value+"  animation-fill-mode: forwards;\n}\n\n",t.value=t.value+e.keyframes,t.value=t.value+e.frameData+"*/\n"},getStyle:function(e,t){var a=this.getFrame(e,t);return a.getAttribute("style")},changeSelectFrame:function(){var e=this.selectFrame,t=this.getFrame(e.value,e.dataset.frameName),a=t.getAttribute("style"),r=this.frameStyle;r.value=a,this.exposureCount.value=t.dataset.frameExposureCount,console.log(t)},setFrameStyle:function(){var e=this.selectFrame,t=this.getFrame(e.value,e.dataset.frameName),a=(t.getAttribute("style"),this.frameStyle);t.setAttribute("style",a.value),console.log(t)},setFrameExposureCount:function(){var e=this.selectFrame,t=this.getFrame(e.value,e.dataset.frameName);t.dataset.frameExposureCount=this.exposureCount.value,console.log(t)},toggle:function(){var e=this.toggleBtn,t=this.form,a=this.output,r=this.body,n=this.framesDiv;"display:none;"===t.getAttribute("style")?(this.clearTest(),t.setAttribute("style",""),a.setAttribute("style",""),n.setAttribute("style",""),r.className+="grid",e.innerHTML="Hide >"):(t.setAttribute("style","display:none;"),a.setAttribute("style","display:none;"),n.setAttribute("style","display:none;"),r.className=r.className.replace(/(?:^|\s)grid(?!\S)/g,""),e.innerHTML="Show >")},clearTest:function(){var e=this.frameName.value,t=document.getElementById(e+"Test");void 0!=t&&t.parentNode.removeChild(t);var a=document.getElementById("animationtest");void 0!=a&&a.parentNode.removeChild(a)},test:function(){this.clearTest();var e=this.frameName.value,t=this.frameClass.value,a=(this.getFrame(1,e),document.createElement("span"));a.setAttribute("id",e+"Test");var r=this.body;r.appendChild(a);var n=document.createElement("style");n.setAttribute("id","animationtest"),n.appendChild(document.createTextNode("")),r.appendChild(n);var s=this._keyFrames(!1);console.log(s.keyframes);var i=s.keyframes.split("\n\n");console.log(i);for(var l=0;l<i.length;l++)i[l].length>0&&n.sheet.insertRule(i[l],l);n.sheet.insertRule("."+e+".animate {animation: "+s.animations+";animation-fill-mode: forwards;}",1),console.log(n.sheet.cssRules),a.className=t+" "+e+" animate";var m=document.getElementsByTagName("form")[0];"display:none;"===m.getAttribute("style")||this.toggle()},init:function(){var e=document.getElementsByTagName("body")[0];this.body=e;var t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("id","tbtn"),t.setAttribute("onclick","window.tfFrames.toggle();"),t.appendChild(document.createTextNode("Hide >")),this.toggleBtn=t,e.appendChild(t);var a=document.createElement("button");a.setAttribute("type","button"),a.setAttribute("id","tbtn"),a.setAttribute("onclick","window.tfFrames.test();"),a.appendChild(document.createTextNode("Test >")),this.testBtn=a,e.appendChild(a);var r=document.createElement("form");this.form=r;var n=document.createElement("ol"),s=document.createElement("li");n.appendChild(s);var i=document.createElement("p");i.appendChild(document.createTextNode("Paste previously generated frame data into textarea below and "));var l=document.createElement("button");l.setAttribute("type","button"),l.setAttribute("onclick","window.tfFrames.loadFrames();"),l.appendChild(document.createTextNode("Load")),this.loadBtn=l,i.appendChild(l),s.appendChild(i);var m=document.createElement("li");n.appendChild(m);var u=document.createElement("p"),o=document.createElement("label");o.appendChild(document.createTextNode("If frames not loaded in step 1, generate: ")),u.appendChild(o);var d=document.createElement("input");d.setAttribute("type","number"),d.setAttribute("name","genFrames"),d.setAttribute("value","50"),d.setAttribute("id","frameCount"),this.frameCount=d,u.appendChild(d),u.appendChild(document.createTextNode(" frames with class "));var c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("value",""),c.setAttribute("id","frameClass"),this.frameClass=c,u.appendChild(c),u.appendChild(document.createTextNode(" with name "));var p=document.createElement("input");p.setAttribute("type","text"),p.setAttribute("value",""),p.setAttribute("id","frameName"),this.frameName=p,u.appendChild(p);var h=document.createElement("button");h.setAttribute("type","button"),h.setAttribute("onclick","window.tfFrames.generateFrames();"),h.appendChild(document.createTextNode("Go >")),this.goBtn=h,u.appendChild(h),m.appendChild(u);var v=document.createElement("li");n.appendChild(v);var f=document.createElement("p");f.appendChild(document.createTextNode("Select "));var b=document.createElement("select");b.setAttribute("name","frame"),b.setAttribute("onchange","window.tfFrames.changeSelectFrame();"),this.selectFrame=b,f.appendChild(b),f.appendChild(document.createTextNode(" frame and set style to "));var C=document.createElement("input");C.setAttribute("type","text"),C.setAttribute("value",""),C.setAttribute("id","frameStyle"),C.setAttribute("style","width:500px;"),C.setAttribute("onchange","window.tfFrames.setFrameStyle();"),this.frameStyle=C,f.appendChild(C);var y=document.createElement("input");y.setAttribute("type","number"),y.setAttribute("value","0"),y.setAttribute("id","frameExposureCount"),y.setAttribute("onchange","window.tfFrames.setFrameExposureCount();"),this.exposureCount=y,f.appendChild(y),v.appendChild(f);var g=document.createElement("li");n.appendChild(g);var A=document.createElement("p");A.appendChild(document.createTextNode("Use "));var E=document.createElement("input");E.setAttribute("type","text"),E.setAttribute("value",""),E.setAttribute("id","frameName2"),this.frameName2=E,A.appendChild(E),A.appendChild(document.createTextNode(" frames and "));var F=document.createElement("button");F.setAttribute("type","button"),F.setAttribute("onclick","window.tfFrames.generateKeyframes();"),F.appendChild(document.createTextNode("Generate Keyframes >")),this.genBtn=F,A.appendChild(F),g.appendChild(A),r.appendChild(n),e.appendChild(r);var N=document.createElement("textarea");N.setAttribute("rows","10"),N.setAttribute("cols","100"),N.setAttribute("id","css"),this.output=N,e.appendChild(N);var x=document.createElement("div");x.setAttribute("class","frames"),this.framesDiv=x,e.appendChild(x),this.toggle()}};