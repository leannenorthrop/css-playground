window.tfFrames={loadFrames:function(){var e=this.output,t=e.value,a=t.split("\n"),r=a[0].split("|")[1],n=a[0].split("|")[0];this.frameCount.value=a.length,this.frameClass.value=n,this.frameName.value=r,this.generateFrames();for(var s=0;s<a.length;s++){var i=a[s].split("|");if(i.length>=5){var l=this.getFrame(i[2],i[1]);l.dataset.frameExposureCount=i[3],l.setAttribute("style",i[4])}}},generateFrames:function(){var e=(this.body,this.output,this.framesDiv),t=this.frameCount.value,a=this.frameClass.value,r=this.frameName.value,n=this.selectFrame;n.dataset.frameName=r,this.frameName2.value=r;for(var s=0,i=e.childElementCount;t>s;){var l=document.createElement("span");l.dataset.frameCount=i+1,l.dataset.frameExposureCount=1,0==s?l.setAttribute("class","opaque frame "+r+(i+1)+" "+a):l.setAttribute("class","ghost frame "+r+(i+1)+" "+a),l.setAttribute("style",""),e.appendChild(l);var u=document.createElement("option");u.setAttribute("value",i+1),u.innerHTML=r+(i+1),n.appendChild(u),s++,i++}},getFrame:function(e,t){for(var a=void 0,r=document.querySelectorAll('[data-frame-count="'+e+'"]'),n=0;n<r.length;){var s=r[n].className.split(" ");if(r[n].dataset.frameCount==e&&s.indexOf(t+e)>=0){a=r[n];break}}return a},_keyFrames:function(e){for(var t=0,a=1,r=this.frameCount.value,n=this.frameName.value,s=this.frameClass.value,i=n,l=0,u="@keyframes "+i+"_"+l+" {\n",m=i+"_"+l+" 1s steps(24) 1 "+l+"s normal, ",d=0,o=1,c="/* Frame Data: \n";r>t;){var p=this.getFrame(a,n),h=4.16*p.dataset.frameExposureCount;if(d+h>100){for(var v=0,b=1;b<=p.dataset.frameExposureCount&&(v=4.16*b,!(d+v>100));b++);v--,h-=v;var f=d+4.16*v;f>99&&(f=100),u+="  "+d+"%,"+f+"% {",e&&(u+="    /* frame "+(t+1)+" rules here */");var A=this.getStyle(a,n);void 0!=A&&(u+=A,c+=s+"|"+n+"|"+a+"|"+A+"\n"),u+="}\n",m+=i+"_"+l+" 1s steps(24) 1 "+l+"s normal, ",l++,o=1,d=0,u+="}\n\n",u+="@keyframes "+i+"_"+l+" {\n"}var C=d+h;C>99&&(C=100),u+="  "+d+"%,"+C+"% {",e&&(u+="    /* frame "+(t+1)+" rules here */");var A=this.getStyle(a,n);void 0!=A&&(u+=A,c+=s+"|"+n+"|"+a+"|"+p.dataset.frameExposureCount+"|"+A+"\n"),u+="}\n",d=C,o++,a++,t++}return u+="}\n\n",{animations:m.substr(0,m.length-2),keyframes:u,frameData:c}},generateKeyframes:function(){var e=this._keyFrames(!0),t=this.output,a=this.frameName.value;t.value="",t.value=t.value+"."+a+".animate {\n",t.value=t.value+"  animation: "+e.animations+";\n",t.value=t.value+"  animation-fill-mode: forwards;\n}\n\n",t.value=t.value+e.keyframes,t.value=t.value+e.frameData+"*/\n"},getStyle:function(e,t){var a=this.getFrame(e,t);return a.getAttribute("style")},changeSelectFrame:function(){var e=document.getElementsByClassName("opaque").length>0?document.getElementsByClassName("opaque")[0]:void 0;void 0!=e&&(e.className=e.className.replace(/(?:^|\s)opaque(?!\S)/g,"ghost"));var t=this.selectFrame,a=this.getFrame(t.value,t.dataset.frameName);a.className=a.className.replace(/(?:^|\s)ghost(?!\S)/g,"opaque");var r=a.getAttribute("style");return this.frameStyle.value=r,this.exposureCount.value=a.dataset.frameExposureCount,console.log(a),!0},setFrameStyle:function(){var e=this.selectFrame,t=this.getFrame(e.value,e.dataset.frameName),a=(t.getAttribute("style"),this.frameStyle);return t.setAttribute("style",a.value),console.log(t),!0},setFrameExposureCount:function(){var e=this.selectFrame,t=this.getFrame(e.value,e.dataset.frameName);return t.dataset.frameExposureCount=this.exposureCount.value,console.log(t),!0},toggle:function(){var e=this.toggleBtn,t=this.form,a=this.output,r=this.body,n=this.framesDiv;"display:none;"===t.getAttribute("style")?(this.clearTest(),t.setAttribute("style",""),a.setAttribute("style",""),n.setAttribute("style",""),r.className+="grid",e.innerHTML="Hide >",this.keepBtn.setAttribute("disabled","")):(t.setAttribute("style","display:none;"),a.setAttribute("style","display:none;"),n.setAttribute("style","display:none;"),r.className=r.className.replace(/(?:^|\s)grid(?!\S)/g,""),e.innerHTML="Show >")},clearTest:function(){var e=this.nameElement.value,t=document.getElementById(e+"Test");void 0!=t&&t.parentNode.removeChild(t);var a=document.getElementById(e+"StyleTest");void 0!=a&&a.parentNode.removeChild(a)},save:function(){var e=this.nameElement.value,t=document.getElementById(e+"StyleTest");void 0!=t&&t.setAttribute("id",e+"Style");var a=document.getElementById(e+"Test");for(void 0!=a&&a.setAttribute("id",e),this.nameElement.value="",this.selectFrame.innerHTML="",this.selectFrame.dataset.frameName="";this.framesDiv.children.length>0;){var r=this.framesDiv.children[0];void 0!=r&&r.parentNode.removeChild(r)}this.frameClass.value="",this.frameStyle.value="",this.frameName.value="",this.frameName2.value="",this.exposureCount.value="1",this.frameCount.value="50"},test:function(){this.clearTest();var e=this.nameElement.value,t=this.frameName.value,a=this.frameClass.value,r=(this.getFrame(1,t),document.createElement("span"));r.setAttribute("id",e+"Test");var n=this.body;n.appendChild(r);var s=document.createElement("style");s.setAttribute("id",e+"StyleTest"),s.appendChild(document.createTextNode("")),n.appendChild(s);var i=this._keyFrames(!1);console.log(i.keyframes);var l=i.keyframes.split("\n\n");console.log(l);for(var u=0;u<l.length;u++)l[u].length>0&&s.sheet.insertRule(l[u],u);s.sheet.insertRule("."+t+".animate {animation: "+i.animations+";animation-fill-mode: forwards;}",1),console.log(s.sheet.cssRules),r.className=a+" "+t+" animate";var m=document.getElementsByTagName("form")[0];"display:none;"===m.getAttribute("style")||this.toggle(),this.keepBtn.removeAttribute("disabled")},init:function(){var e=document.getElementsByTagName("body")[0];this.body=e;var t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("id","tbtn"),t.setAttribute("onclick","window.tfFrames.toggle();"),t.setAttribute("tabindex","1"),t.appendChild(document.createTextNode("Hide >")),this.toggleBtn=t,e.appendChild(t);var a=document.createElement("button");a.setAttribute("type","button"),a.setAttribute("id","tbtn"),a.setAttribute("onclick","window.tfFrames.test();"),a.setAttribute("tabindex","2"),a.appendChild(document.createTextNode("Test >")),this.testBtn=a,e.appendChild(a);var r=document.createElement("button");r.setAttribute("type","button"),r.setAttribute("id","keepBtn"),r.setAttribute("onclick","window.tfFrames.save();"),r.setAttribute("disabled",""),r.setAttribute("tabindex","3"),r.appendChild(document.createTextNode("Keep")),this.keepBtn=r,e.appendChild(r);var n=document.createElement("form");this.form=n;var s=document.createElement("ol"),i=document.createElement("li");s.appendChild(i);var l=document.createElement("p"),u=document.createElement("label");u.innerHTML="Give a name ",l.appendChild(u);var m=document.createElement("input");m.setAttribute("type","text"),m.setAttribute("id","name"),m.setAttribute("tabindex","4"),this.nameElement=m,l.appendChild(m),i.appendChild(l);var d=document.createElement("li");s.appendChild(d);var o=document.createElement("p");o.appendChild(document.createTextNode("(Optional) Paste previously generated frame data into textarea below and "));var c=document.createElement("button");c.setAttribute("type","button"),c.setAttribute("onclick","window.tfFrames.loadFrames();"),c.setAttribute("tabindex","5"),c.appendChild(document.createTextNode("Load")),this.loadBtn=c,o.appendChild(c),d.appendChild(o);var p=document.createElement("li");s.appendChild(p);var h=document.createElement("p"),v=document.createElement("label");v.appendChild(document.createTextNode("If frames not loaded in step 1, generate: ")),h.appendChild(v);var b=document.createElement("input");b.setAttribute("type","number"),b.setAttribute("name","genFrames"),b.setAttribute("value","50"),b.setAttribute("id","frameCount"),b.setAttribute("tabindex","6"),this.frameCount=b,h.appendChild(b),h.appendChild(document.createTextNode(" frames with class "));var f=document.createElement("input");f.setAttribute("type","text"),f.setAttribute("value",""),f.setAttribute("id","frameClass"),f.setAttribute("tabindex","7"),this.frameClass=f,h.appendChild(f),h.appendChild(document.createTextNode(" with name "));var A=document.createElement("input");A.setAttribute("type","text"),A.setAttribute("value",""),A.setAttribute("id","frameName"),A.setAttribute("tabindex","8"),this.frameName=A,h.appendChild(A);var C=document.createElement("button");C.setAttribute("type","button"),C.setAttribute("onclick","window.tfFrames.generateFrames();"),C.setAttribute("tabindex","9"),C.appendChild(document.createTextNode("Go >")),this.goBtn=C,h.appendChild(C),p.appendChild(h);var y=document.createElement("li");s.appendChild(y);var g=document.createElement("p");g.appendChild(document.createTextNode("Select "));var E=document.createElement("select");E.setAttribute("name","frame"),E.setAttribute("onchange","window.tfFrames.changeSelectFrame();"),E.setAttribute("tabindex","10"),this.selectFrame=E,g.appendChild(E),g.appendChild(document.createTextNode(" frame and set style to "));var x=document.createElement("input");x.setAttribute("type","text"),x.setAttribute("value",""),x.setAttribute("id","frameStyle"),x.setAttribute("style","width:500px;"),x.setAttribute("onkeyup","window.tfFrames.setFrameStyle();"),x.setAttribute("tabindex","11"),this.frameStyle=x,g.appendChild(x);var N=document.createElement("input");N.setAttribute("type","number"),N.setAttribute("value","1"),N.setAttribute("id","frameExposureCount"),N.setAttribute("onblur","window.tfFrames.setFrameExposureCount();"),N.setAttribute("tabindex","12"),this.exposureCount=N,g.appendChild(N),y.appendChild(g);var F=(document.createElement("li"),document.createElement("p"));F.appendChild(document.createTextNode("Use "));var T=document.createElement("input");T.setAttribute("type","text"),T.setAttribute("value",""),T.setAttribute("id","frameName2"),this.frameName2=T,F.appendChild(T),F.appendChild(document.createTextNode(" frames and "));var w=document.createElement("button");w.setAttribute("type","button"),w.setAttribute("onclick","window.tfFrames.generateKeyframes();"),w.appendChild(document.createTextNode("Generate Keyframes >")),this.genBtn=w,F.appendChild(w),n.appendChild(s),e.appendChild(n);var S=document.createElement("textarea");S.setAttribute("rows","10"),S.setAttribute("cols","100"),S.setAttribute("id","css"),S.setAttribute("tabindex","13"),this.output=S,n.appendChild(S);var k=document.createElement("div");k.setAttribute("class","frames"),this.framesDiv=k,e.appendChild(k),this.toggle()}};